# Render Blueprint Configuration
# https://render.com/docs/blueprint-spec

services:
  # ============================================
  # Backend API Service (Python/Flask)
  # ============================================
  - type: web
    name: study-pilot-backend
    runtime: python
    region: oregon  # or choose: ohio, singapore, frankfurt
    plan: free      # Options: free, starter, standard, pro
    
    # Build Configuration
    buildCommand: |
      pip install --upgrade pip
      pip install -r requirements.txt
    
    # Start Command (production server)
    startCommand: gunicorn --workers 2 --threads 4 --bind 0.0.0.0:$PORT app:app
    
    # Health Check
    healthCheckPath: /api/health
    
    # Environment Variables
    envVars:
      - key: PYTHON_VERSION
        value: "3.10.0"
      - key: FLASK_ENV
        value: production
      - key: OPENAI_API_KEY
        sync: false  # Set manually in Render dashboard
      - key: FRONTEND_URL
        sync: false  # Set to your Vercel frontend URL
      
    # Auto Deploy on push
    autoDeploy: true

# ============================================
# Static Site (Optional - for frontend)
# Uncomment if deploying frontend on Render instead of Vercel
# ============================================
#   - type: web
#     name: study-pilot-frontend
#     runtime: static
#     buildCommand: cd frontend && npm install && npm run build
#     staticPublishPath: frontend/dist
#     routes:
#       - type: rewrite
#         source: /*
#         destination: /index.html
#     envVars:
#       - key: VITE_API_BASE_URL
#         value: https://study-pilot-backend.onrender.com
